{"name": "test_add_legal_entity[positive_password-positive_name]", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка, название в таблице не совпадает\nassert '' == 'Закупка горного меда'\n  - Закупка горного меда", "trace": "driver = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"8dd90bdf24f9da3f2074740df0fd6ffc\")>, name = 'sf1@gmail.com', password = '111'\n\n    @allure.feature('add_legal_entity')\n    @allure.story(\"Добавление нового юридического лица в разделе 'клиенты'\")\n    @pytest.mark.parametrize('name', [name_user], ids=[\"positive_name\"])\n    @pytest.mark.parametrize('password', [psw_user], ids=[\"positive_password\"])\n    def test_add_legal_entity(driver, name, password):\n    \n        # Авторизация в системе с валидными данными\n        with allure.step(\"Авторизация в системе\"):\n            page = AuthPage(driver)\n            page.name.send_keys(name)\n            page.password.send_keys(password)\n            page.btn_input.click()\n            catalog_title = page.title.get_text()\n    \n        # Проверка, что авторизация прошла успешно\n        with allure.step(\"Проверка авторизации\"):\n            assert page.get_current_url() == \"https://sf.leadupcrm.pro/service/clients\", 'Ошибка, URL не совпадают'\n            print('\\n', \"URL корректа\")\n            assert catalog_title == 'Клиенты', 'Название раздела не совпадает'\n            print(catalog_title, '== Клиенты')\n            print(\"Авторизация прошла успешно\")\n    \n        #Создание нового юридического лица\n        with allure.step(\"Открытие формы для создания нового юридического лица.\"):\n            page.btn_plus.click()\n            page.btn_icon_legal_entity.click()\n            current_form_title = page.form_title.get_text()\n        with allure.step(\"Проверка, что форма для создания нового юридического лица открылась.\"):\n            print([current_form_title])\n            assert current_form_title == 'Новое юридическое лицо', 'Ошибка, название формы не совпадает'\n        with allure.step(\"Добавление данных в форму.\"):\n            page.search_field.click()\n            page.search_field.send_keys('ПАО \"ТГК-1\"')\n            page.search_field.click()\n            page.choose_legal_entity.wait_until_not_visible()\n            print(page.choose_legal_entity.get_text())\n            page.choose_legal_entity.click()\n            page.short_name.highlight_and_make_screenshot(\"../screen/screen.png\")\n        #Форма не отдает вносимые данные. Поэтому проверка скриншотом.\n        #page.short_name.click()\n        # get_short_name = page.short_name.get_text()\n        # print(get_short_name)\n        # assert get_short_name == 'Новое юридическое лицо', 'Ошибка, название формы не совпадает'\n        main_tab = driver.current_window_handle\n        print(main_tab)\n        with allure.step(\"Сохранение добавленных данных.\"):\n            page.btn_save.click()\n            page.wait_page_loaded(5)\n            list_of_tabs = driver.window_handles\n            print(list_of_tabs)\n            second_tab = driver.current_window_handle\n            print(second_tab)\n            driver.switch_to.window(list_of_tabs[1])  # Подставит дескриптор по индексу 1, т.е второй элемент списка\n        with allure.step(\"Проверка, что данные в открытой вкладке, принадлежат добавленному клиенту.\"):\n            page.title_page.highlight_and_make_screenshot(\"../screen/screen1.png\")\n            get_title_page = page.title_page.get_text()\n            print(get_title_page)\n            assert get_title_page == 'ПАО \"ТГК-1\"', 'Ошибка, название страницы не совпадает'\n    \n        with allure.step(\"Проверка, что новое юридическое лицо добавлено в таблицу.\"):\n            # Проверка, что новое юридическое лицо добавлено в таблицу\n            driver.switch_to.window(list_of_tabs[0])\n            get_new_client_in_table = page.add_new_client_in_table.get_text()\n            assert get_new_client_in_table == 'ПАО \"ТГК-1\"', 'Ошибка, название в таблице не совпадает'\n    \n        driver.switch_to.window(list_of_tabs[1])\n    \n        with allure.step(\"Выбор добавление расчетного счета для нового юридического лица.\"):\n            # Добавление расчетного счета для нового юридического лица\n            page.payment_accounts.click()\n            page.btn_new_payment_account.click()\n            current_form_title = page.form_title.get_text()\n        with allure.step(\"Проверка, что открыта форма расчетного счета.\"):\n            print(current_form_title)\n            assert current_form_title == 'Новый расчетный счет', 'Ошибка, название формы не совпадает'\n        with allure.step(\"Добавление данных расчетного счета для нового юридического лица.\"):\n            page.field_name.click()\n            page.field_name.send_keys('Новый расчетный счет')\n            page.bank_payment_account.click()\n            page.bank_payment_account.send_keys('ВТБ')\n            page.bic_payment_account.click()\n            page.bic_payment_account.send_keys('123456789')\n            page.inn_payment_account.click()\n            page.inn_payment_account.send_keys('1234567891')\n            page.ogrn_payment_account.click()\n            page.ogrn_payment_account.send_keys('1234567890123')\n            page.kpp_payment_account.click()\n            page.kpp_payment_account.send_keys('123456789')\n            page.account_payment_account.click()\n            page.account_payment_account.send_keys('12345678901234567890')\n            page.correspondent_payment_account.click()\n            page.correspondent_payment_account.send_keys('12345678901234567890')\n            page.address_payment_account.click()\n            page.address_payment_account.send_keys('12345, Mira')\n        with allure.step(\"Проверка, что данные успешно сохранились.\"):\n            page.btn_save.click()\n            account_title = page.new_payment_account_title.get_text()\n            print(account_title)\n            assert account_title == 'Новый расчетный счет', 'Ошибка, название формы не совпадает'\n    \n        with allure.step(\"Добавление новой задачи.\"):\n            # Добавление новой задачи\n            page.link_tasks.click()\n            page.btn_plus.click()\n            current_form_title = page.form_title.get_text()\n        with allure.step(\"Проверка, что открыта форма для добавления новой задачи.\"):\n            print(current_form_title)\n            assert current_form_title == 'Новая задача', 'Ошибка, название формы не совпадает'\n        with allure.step(\"Внесение данных по новой задаче.\"):\n            page.field_name.click()\n            page.field_name.send_keys('Заключить договор с ООО \"ГКП №1\"')\n            page.task_begin_date.click()\n            page.task_begin_date.send_keys('19112024')\n            page.task_begin_time.click()\n            page.task_begin_time.send_keys('1200')\n            page.task_deadline_date.click()\n            page.task_deadline_date.send_keys('21112024')\n            page.task_deadline_time.click()\n            page.task_deadline_time.send_keys('1200')\n            page.task_description.click()\n            page.task_description.send_keys('Сроки заключения договора')\n            page.type_task_select_box.click()\n            page.type_task_select_box_choice.click()\n            page.btn_save.click()\n    \n        with allure.step(\"Проверка, что данные сохранились.\"):\n            # Проверка, что задача добавлена\n            page.wait_page_loaded(5)\n            list_of_tabs = driver.window_handles\n            print(list_of_tabs)\n            third_tab = driver.current_window_handle\n            print(third_tab)\n            driver.switch_to.window(list_of_tabs[2])  # Подставит дескриптор по индексу 1, т.е второй элемент списка\n            page.title_page.highlight_and_make_screenshot(\"../screen/screen2.png\")\n            get_name = page.name_check.get_text()\n            print(get_name)\n            assert get_name == 'Заключить договор с ООО \"ГКП №1\"', 'Ошибка, название страницы не совпадает'\n    \n        with allure.step(\"Проверка, что новая задача для юридического лица добавлена в таблицу.\"):\n            # Проверка, что новая задача для юридического лица добавлена в таблицу\n            driver.switch_to.window(list_of_tabs[1])\n            driver.refresh()\n            get_count_tasks = page.count_tasks.get_attribute(\"textContent\")\n            print(get_count_tasks)\n            #assert get_new_task_in_table == 'ПАО \"ТГК-1\"', 'Ошибка, название в таблице не совпадает'\n            get_new_task_in_table = page.table_task_name.get_text()\n            page.title_page.highlight_and_make_screenshot(\"../screen/screen3.png\")\n            assert get_new_task_in_table == 'Заключить договор с ООО \"ГКП №1\"', 'Ошибка, название в таблице не совпадает'\n    \n        #driver.switch_to.window(list_of_tabs[1])\n    \n        with allure.step(\"Добавление новой сделки.\"):\n        # Добавление новой сделки\n            page.link_transactions.click()\n            page.btn_plus.click()\n            current_form_title = page.form_title.get_text()\n        with allure.step(\"Проверка, что форма открылась.\"):\n            print(current_form_title)\n            assert current_form_title == 'Новая сделка', 'Ошибка, название формы не совпадает'\n            page.field_name.click()\n            page.field_name.send_keys('Закупка горного меда')\n            page.select_box_client.click()\n            page.select_box_choice_client.wait_until_not_visible()\n            page.select_box_choice_client.click()\n            client_name = page.select_box_client_name.get_text()\n            print(client_name)\n            page.btn_save.click()\n    \n        with allure.step(\"Проверка, что данные добавились.\"):\n            # Проверка, что сделка добавлена\n            page.wait_page_loaded(5)\n            list_of_tabs = driver.window_handles\n            print(list_of_tabs)\n            third_tab = driver.current_window_handle\n            print(third_tab)\n            driver.switch_to.window(list_of_tabs[3])  # Подставит дескриптор по индексу 1, т.е второй элемент списка\n            page.title_page.highlight_and_make_screenshot(\"../screen/screen4.png\")\n            get_name = page.name_check.get_text()\n            print(get_name)\n            assert get_name == 'Закупка горного меда', 'Ошибка, название страницы не совпадает'\n    \n        with allure.step(\"Проверка, что новая задача для юридического лица добавлена в таблицу.\"):\n            # Проверка, что новая задача для юридического лица добавлена в таблицу\n            driver.switch_to.window(list_of_tabs[1])\n            get_count_tasks = page.count_tasks.get_text()\n            print(get_count_tasks)\n            # assert get_new_task_in_table == 'ПАО \"ТГК-1\"', 'Ошибка, название в таблице не совпадает'\n            get_new_task_in_table = page.table_task_name.get_text()\n            page.title_page.highlight_and_make_screenshot(\"../screen/screen5.png\")\n>           assert get_new_task_in_table == 'Закупка горного меда', 'Ошибка, название в таблице не совпадает'\nE           AssertionError: Ошибка, название в таблице не совпадает\nE           assert '' == 'Закупка горного меда'\nE             - Закупка горного меда\n\ntests\\test_add_legal_entity.py:196: AssertionError"}, "steps": [{"name": "Авторизация в системе", "status": "passed", "start": 1730314784943, "stop": 1730314794085}, {"name": "Проверка авторизации", "status": "passed", "start": 1730314794085, "stop": 1730314794091}, {"name": "Открытие формы для создания нового юридического лица.", "status": "passed", "start": 1730314794091, "stop": 1730314795887}, {"name": "Проверка, что форма для создания нового юридического лица открылась.", "status": "passed", "start": 1730314795888, "stop": 1730314795888}, {"name": "Добавление данных в форму.", "status": "passed", "start": 1730314795888, "stop": 1730314800216}, {"name": "Сохранение добавленных данных.", "status": "passed", "start": 1730314800217, "stop": 1730314803884}, {"name": "Проверка, что данные в открытой вкладке, принадлежат добавленному клиенту.", "status": "passed", "start": 1730314803884, "stop": 1730314804117}, {"name": "Проверка, что новое юридическое лицо добавлено в таблицу.", "status": "passed", "start": 1730314804117, "stop": 1730314804197}, {"name": "Выбор добавление расчетного счета для нового юридического лица.", "status": "passed", "start": 1730314804212, "stop": 1730314805469}, {"name": "Проверка, что открыта форма расчетного счета.", "status": "passed", "start": 1730314805469, "stop": 1730314805469}, {"name": "Добавление данных расчетного счета для нового юридического лица.", "status": "passed", "start": 1730314805469, "stop": 1730314830672}, {"name": "Проверка, что данные успешно сохранились.", "status": "passed", "start": 1730314830672, "stop": 1730314831923}, {"name": "Добавление новой задачи.", "status": "passed", "start": 1730314831923, "stop": 1730314833868}, {"name": "Проверка, что открыта форма для добавления новой задачи.", "status": "passed", "start": 1730314833868, "stop": 1730314833869}, {"name": "Внесение данных по новой задаче.", "status": "passed", "start": 1730314833869, "stop": 1730314852851}, {"name": "Проверка, что данные сохранились.", "status": "passed", "start": 1730314852851, "stop": 1730314856248}, {"name": "Проверка, что новая задача для юридического лица добавлена в таблицу.", "status": "passed", "start": 1730314856248, "stop": 1730314857131}, {"name": "Добавление новой сделки.", "status": "passed", "start": 1730314857131, "stop": 1730314858952}, {"name": "Проверка, что форма открылась.", "status": "passed", "start": 1730314858952, "stop": 1730314864328}, {"name": "Проверка, что данные добавились.", "status": "passed", "start": 1730314864328, "stop": 1730314867618}, {"name": "Проверка, что новая задача для юридического лица добавлена в таблицу.", "status": "failed", "statusDetails": {"message": "AssertionError: Ошибка, название в таблице не совпадает\nassert '' == 'Закупка горного меда'\n  - Закупка горного меда\n", "trace": "  File \"C:\\Users\\denis\\PycharmProjects\\AtolSoft\\tests\\test_add_legal_entity.py\", line 196, in test_add_legal_entity\n    assert get_new_task_in_table == 'Закупка горного меда', 'Ошибка, название в таблице не совпадает'\n"}, "start": 1730314867619, "stop": 1730314888359}], "parameters": [{"name": "password", "value": "'111'"}, {"name": "name", "value": "'sf1@gmail.com'"}], "start": 1730314784943, "stop": 1730314888360, "uuid": "50e668ee-a0a0-43a6-b8da-04ed94d2fb5c", "historyId": "33aa102aa07e51e5529580783d5482a4", "testCaseId": "22dd450be7885af833d8c9bc578f3027", "fullName": "tests.test_add_legal_entity#test_add_legal_entity", "labels": [{"name": "story", "value": "Добавление нового юридического лица в разделе 'клиенты'"}, {"name": "feature", "value": "add_legal_entity"}, {"name": "parentSuite", "value": "tests"}, {"name": "suite", "value": "test_add_legal_entity"}, {"name": "host", "value": "DESKTOP-J7U5TG2"}, {"name": "thread", "value": "9072-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.test_add_legal_entity"}]}